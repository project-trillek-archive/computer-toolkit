<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on January 13, 2015 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>vasm manual: 5. Oldstyle Syntax Module</title>

<meta name="description" content="vasm manual: 5. Oldstyle Syntax Module">
<meta name="keywords" content="vasm manual: 5. Oldstyle Syntax Module">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.roman {font-family:serif; font-weight:normal;}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="vasm_3.html#Mot-Syntax-Module" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="vasm_5.html#Simple-binary-output-module" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="vasm_0.html#General-9" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="vasm_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="vasm_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<hr size="2">
<a name="Oldstyle-Syntax-Module"></a>
<a name="Oldstyle-Syntax-Module-1"></a>
<h1 class="chapter">5. Oldstyle Syntax Module</h1>
<p>This chapter describes the oldstyle syntax module suitable
for some 8-bit CPUs (6502, 680x, 68HC1x, Z80, etc.),
which is available with the extension <code>oldstyle</code>.
</p>
<hr size="6">
<a name="Legal-14"></a>
<h2 class="section">5.1 Legal</h2>

<p>    This module is copyright in 2002-2014 by Frank Wille.
</p>
<p>    This archive may be redistributed without modifications and used
    for non-commercial purposes.
</p>
<p>    Distributing modified versions and commercial usage needs my written
    consent.
</p>
<p>    Certain modules may fall under additional copyrights.
</p>
<hr size="6">
<a name="Additional-options-for-this-version-1"></a>
<h2 class="section">5.2 Additional options for this version</h2>
 
<p>This syntax module provides the following additional options:
</p> 
<dl compact="compact">
<dt> &lsquo;<samp>-dotdir</samp>&rsquo;</dt>
<dd><p> Directives have to be preceded by a dot (<code>.</code>).
</p>
</dd>
<dt> &lsquo;<samp>-autoexp</samp>&rsquo;</dt>
<dd><p> Automatically export all non-local symbols, making them visible
 to other modules during linking.
</p>
</dd>
</dl>

<hr size="6">
<a name="General-Syntax"></a>
<h2 class="section">5.3 General Syntax</h2>

<p>Labels always start at the first column and may be terminated by a
colon (<code>:</code>), but don&rsquo;t need to. In the last case the mnemonic
needs to be separated from the label by whitespace (not required in
any case, e.g. <code>=</code>).
</p>
<p>Local labels are preceded by &rsquo;<code>.</code>&rsquo; or terminated by &rsquo;<code>$</code>&rsquo;.
For the rest, any alphanumeric character including &rsquo;<code>_</code>&rsquo; is allowed.
Local labels are valid between two global label definitions.
</p>
<p>It is allowed, but not recommended, to refer to any local symbol starting with
&rsquo;<code>.</code>&rsquo; in the source, by preceding its name with the name of the last
global symbol, which was defined before it: <code>global_name.local_name</code>.
</p>
<p>The operands are separated from the mnemonic by whitespace. Multiple
operands are separated by comma (<code>,</code>).
</p>
<p>Make sure that you don&rsquo;t define a label on the same line as a
directive for conditional assembly (if, else, endif)! This is not supported.
</p>
<p>Comments are introduced by the comment character <code>;</code>.
The rest of the line will be ignored.
</p>
<p>Example:
</p>
<p><code>mylabel instr op1,op2  ;comment</code>
</p>
<p>In expressions, numbers starting with <code>$</code> are hexadecimal (e.g.
<code>$fb2c</code>). For Z80 also <code>&amp;</code> may be used as a hexadecimal prefix,
but make sure to avoid conflicts with the and-operator (either by using
parentheses or blanks).
<code>%</code> introduces binary numbers (e.g. <code>%1100101</code>).
Numbers starting with <code>@</code> are assumed to be octal numbers, e.g.
<code>@237</code> (except for Z80, where it means binary).
A special case is a digit followed by a <code>#</code>, which can be used to
define an arbitrary base between 2 and 9 (e.g. <code>4#3012</code>).
Intel-style constant suffixes are supported: <code>h</code> for hexadecimal,
<code>d</code> for decimal, <code>o</code> or <code>q</code> for octal and <code>b</code> for
binary. Hexadecimal intel-style constants must start with a digit (prepend
<code>0</code>, when required).
Also C-style prefixes are supported for hexadecimal (<code>0x</code>) and
binary (<code>0b</code>).
All other numbers starting with a digit are decimal, e.g. <code>1239</code>.
</p>

<hr size="6">
<a name="Directives-1"></a>
<h2 class="section">5.4 Directives</h2>

<p>The following directives are supported by this syntax module (if the
CPU- and output-module allow it):
</p>
<dl compact="compact">
<dt> <code>&lt;symbol&gt; = &lt;expression&gt;</code></dt>
<dd><p>      Equivalent to <code>&lt;symbol&gt; equ &lt;expression&gt;</code>.
</p>
</dd>
<dt> <code>abyte &lt;offset&gt;,&lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      Write the integer or string constant operands into successive
      bytes of memory in the current section while adding the constant
      &lt;offset&gt; to each byte. Any combination of integer and character
      string constant operands is permitted.
</p>
</dd>
<dt> <code>addr &lt;exp1&gt;[,&lt;exp2&gt;...]</code></dt>
<dd><p>      Equivalent to <code>word &lt;exp1&gt;[,&lt;exp2&gt;...]</code>.
</p>
</dd>
<dt> <code>align &lt;bitcount&gt;</code></dt>
<dd><p>      Insert as much zero bytes as required to reach an address where
      &lt;bit_count&gt; low order bits are zero. For example <code>align 2</code> would
      make an alignment to the next 32-bit boundary.
</p>
</dd>
<dt> <code>asc &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      Equivalent to <code>byte &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code>.
</p>
</dd>
<dt> <code>ascii &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      See <code>defm</code>. 
</p>
</dd>
<dt> <code>asciiz &quot;&lt;string1&gt;&quot;[,&quot;&lt;string2&gt;&quot;...]</code></dt>
<dd><p>      See <code>string</code>. 
</p>
</dd>
<dt> <code>assert &lt;expression&gt;[,&lt;message&gt;]</code></dt>
<dd><p>      Display an error with the optional &lt;message&gt; when the expression
      is false.
</p>
</dd>
<dt> <code>binary &lt;file&gt;</code></dt>
<dd><p>      Inserts the binary contents of &lt;file&gt; into the object code at
      this position. The file will be searched first in the current
      directory, then in all paths defined by &lsquo;<samp>-I</samp>&rsquo; or <code>incdir</code>
      in the order of occurence.
</p>
</dd>
<dt> <code>blk &lt;exp&gt;[,&lt;fill&gt;]</code></dt>
<dd><p>      Insert &lt;exp&gt; zero or &lt;fill&gt; bytes into the current section.
</p>
</dd>
<dt> <code>blkw &lt;exp&gt;[,&lt;fill&gt;]</code></dt>
<dd><p>      Insert &lt;exp&gt; zero or &lt;fill&gt; 16-bit words into the current section,
      using the endianess of the target CPU.
</p>
</dd>
<dt> <code>bsz exp&gt;[,&lt;fill&gt;]</code></dt>
<dd><p>      Equivalent to <code>blk &lt;exp&gt;[,&lt;fill&gt;]</code>.
</p>
</dd>
<dt> <code>byt</code></dt>
<dd><p>      Increases the program counter by one.
      Equivalent to <code>blk 1,0</code>.
</p>
</dd>
<dt> <code>byte &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      Assign the integer or string constant operands into successive
      bytes of memory in the current section. Any combination of integer
      and character string constant operands is permitted.
</p>
</dd>
<dt> <code>data &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      Equivalent to <code>byte &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code>.
</p>
</dd>
<dt> <code>db &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      Equivalent to <code>byte &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code>.
</p>
</dd>
<dt> <code>dc &lt;exp&gt;[,&lt;fill&gt;]</code></dt>
<dd><p>      Equivalent to <code>blk &lt;exp&gt;[,&lt;fill&gt;]</code>.
</p>
</dd>
<dt> <code>defb &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      Equivalent to <code>byte &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code>.
</p>
</dd>
<dt> <code>defc &lt;symbol&gt; = &lt;expression&gt;</code></dt>
<dd><p>      Define a new program symbol with the name &lt;symbol&gt; and assign to it
      the value of &lt;expression&gt;. Defining &lt;symbol&gt; twice will cause
      an error.
</p>
</dd>
<dt> <code>defl &lt;exp1&gt;[,&lt;exp2&gt;...]</code></dt>
<dd><p>      Assign the values of the operands into successive 32-bit integers
      of memory in the current section, using the endianess of the target
      CPU.
</p>
</dd>
<dt> <code>defp &lt;exp1&gt;[,&lt;exp2&gt;...]</code></dt>
<dd><p>      Assign the values of the operands into successive 24-bit integers
      of memory in the current section, using the endianess of the target
      CPU.
</p>
</dd>
<dt> <code>defm &quot;string&quot;</code></dt>
<dd><p>      Equivalent to <code>text &quot;string&quot;</code>.
</p>
</dd>
<dt> <code>defw &lt;exp1&gt;[,&lt;exp2&gt;...]</code></dt>
<dd><p>      Equivalent to <code>word &lt;exp1&gt;[,&lt;exp2&gt;...]</code>.
</p>
</dd>
<dt> <code>dfb &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      Equivalent to <code>byte &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code>.
</p>
</dd>
<dt> <code>dfw &lt;exp1&gt;[,&lt;exp2&gt;...]</code></dt>
<dd><p>      Equivalent to <code>word &lt;exp1&gt;[,&lt;exp2&gt;...]</code>.
</p>
</dd>
<dt> <code>defs &lt;exp&gt;[,&lt;fill&gt;]</code></dt>
<dd><p>      Equivalent to <code>blk &lt;exp&gt;[,&lt;fill&gt;]</code>.
</p>
</dd>
<dt> <code>dephase</code></dt>
<dd><p>      Equivalent to <code>rend</code>.
</p>
</dd>
<dt> <code>ds &lt;exp&gt;[,&lt;fill&gt;]</code></dt>
<dd><p>      Equivalent to <code>blk &lt;exp&gt;[,&lt;fill&gt;]</code>.
</p>
</dd>
<dt> <code>dsb &lt;exp&gt;[,&lt;fill&gt;]</code></dt>
<dd><p>      Equivalent to <code>blk &lt;exp&gt;[,&lt;fill&gt;]</code>.
</p>
</dd>
<dt> <code>dsw &lt;exp&gt;[,&lt;fill&gt;]</code></dt>
<dd><p>      Equivalent to <code>blkw &lt;exp&gt;[,&lt;fill&gt;]</code>.
</p>
</dd>
<dt> <code>dw &lt;exp1&gt;[,&lt;exp2&gt;...]</code></dt>
<dd><p>      Equivalent to <code>word &lt;exp1&gt;[,&lt;exp2&gt;...]</code>.
</p>
</dd>
<dt> <code>end</code></dt>
<dd><p>      Assembly will terminate behind this line.
</p>
</dd>
<dt> <code>endif</code></dt>
<dd><p>      Ends a section of conditional assembly.
</p>
</dd>
<dt> <code>el</code></dt>
<dd><p>      Equivalent to <code>else</code>.
</p>
</dd>
<dt> <code>else</code></dt>
<dd><p>      Assemble the following lines when the previous <code>if</code>-condition
      was false.
</p>
</dd>
<dt> <code>ei</code></dt>
<dd><p>      Equivalent to <code>endif</code>. (Not available for Z80 CPU)
</p>
</dd>
<dt> <code>endm</code></dt>
<dd><p>      Ends a macro definition.
</p>
</dd>
<dt> <code>endmac</code></dt>
<dd><p>      Ends a macro definition.
</p>
</dd>
<dt> <code>endmacro</code></dt>
<dd><p>      Ends a macro definition.
</p>
</dd>
<dt> <code>endr</code></dt>
<dd><p>      Ends a repetition block.
</p>
</dd>
<dt> <code>endrep</code></dt>
<dd><p>      Ends a repetition block.
</p>
</dd>
<dt> <code>endrepeat</code></dt>
<dd><p>      Ends a repetition block.
</p>
</dd>
<dt> <code>endstruct</code></dt>
<dd><p>      Ends a structure definition.
</p>
</dd>
<dt> <code>endstructure</code></dt>
<dd><p>      Ends a structure definition.
</p>
</dd>
<dt> <code>&lt;symbol&gt; eq &lt;expression&gt;</code></dt>
<dd><p>      Equivalent to <code>&lt;symbol&gt; equ &lt;expression&gt;</code>.
</p>
</dd>
<dt> <code>&lt;symbol&gt; equ &lt;expression&gt;</code></dt>
<dd><p>      Define a new program symbol with the name &lt;symbol&gt; and assign to it
      the value of &lt;expression&gt;. Defining &lt;symbol&gt; twice will cause
      an error.
</p>
</dd>
<dt> <code>extern  &lt;symbol&gt;[,&lt;symbol&gt;...]</code></dt>
<dd><p>        See <code>global</code>.
</p>
</dd>
<dt> <code>even</code></dt>
<dd><p>      Aligns to an even address. Equivalent to <code>align 1</code>.
</p>
</dd>
<dt> <code>fail &lt;message&gt;</code></dt>
<dd><p>      Show an error message including the &lt;message&gt; string. Do not generate
      an ouput file.
</p>
</dd>
<dt> <code>fill &lt;exp&gt;</code></dt>
<dd><p>      Equivalent to <code>blk &lt;exp&gt;,0</code>.
</p>
</dd>
<dt> <code>fcb &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      Equivalent to <code>byte &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code>.
</p>
</dd>
<dt> <code>fcc &quot;&lt;string&gt;&quot;</code></dt>
<dd><p>      Equivalent to <code>text</code>.
</p>
</dd>
<dt> <code>fdb &lt;exp1&gt;[,&lt;exp2&gt;,&quot;&lt;string1&gt;&quot;...]</code></dt>
<dd><p>      Equivalent to <code>word &lt;exp1&gt;[,&lt;exp2&gt;...]</code>.
</p>
</dd>
<dt> <code>global &lt;symbol&gt;[,&lt;symbol&gt;...]</code></dt>
<dd><p>      Flag &lt;symbol&gt; as an external symbol, which means that &lt;symbol&gt; is
      visible to all modules in the linking process. It may be either
      defined or undefined.  
</p>
</dd>
<dt> <code>if &lt;expression&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;expression&gt; is non-zero.
</p>
</dd>
<dt> <code>ifdef &lt;symbol&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;symbol&gt; is defined.
</p>
</dd>
<dt> <code>ifndef &lt;symbol&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;symbol&gt; is undefined.
</p>
</dd>
<dt> <code>ifd &lt;symbol&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;symbol&gt; is defined.
</p>
</dd>
<dt> <code>ifnd &lt;symbol&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;symbol&gt; is undefined.
</p>
</dd>
<dt> <code>ifeq &lt;expression&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;expression&gt; is zero.
</p>
</dd>
<dt> <code>ifne &lt;expression&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;expression&gt; is non-zero.
</p>
</dd>
<dt> <code>ifgt &lt;expression&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;expression&gt; is
      greater than zero.
</p>
</dd>
<dt> <code>ifge &lt;expression&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;expression&gt; is
      greater than zero or equal.
</p>
</dd>
<dt> <code>iflt &lt;expression&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;expression&gt; is
      less than zero.
</p>
</dd>
<dt> <code>ifle &lt;expression&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;expression&gt; is
      less than zero or equal.
</p>
</dd>
<dt> <code>ifused &lt;symbol&gt;</code></dt>
<dd><p>      Conditionally assemble the following lines if &lt;symbol&gt; has been
      previously referenced in an expression or in a parameter of an opcode.
      Issue a warning, when &lt;symbol&gt; is already defined.
      Note that <code>ifused</code> does not work, when the symbol has only been
      used in the following lines of the source.
</p>
</dd>
<dt> <code>incbin &lt;file&gt;[,&lt;offset&gt;[,&lt;nbytes&gt;]]</code></dt>
<dd><p>      Inserts the binary contents of &lt;file&gt; into the object code at
      this position. When &lt;offset&gt; is specified, then the given number
      of bytes will be skipped at the beginning of the file. The optional
      &lt;nbytes&gt; argument specifies the maximum number of bytes to be read
      from that file.
      The file will be searched first in the current directory, then in all
      paths defined by &lsquo;<samp>-I</samp>&rsquo; or <code>incdir</code> in the order of occurence.
</p>
</dd>
<dt> <code>incdir &lt;path&gt;</code></dt>
<dd><p>      Add another path to search for include files to the list of
      known paths. Paths defined with &lsquo;<samp>-I</samp>&rsquo; on the command line are
      searched first.
</p>
</dd>
<dt> <code>include &lt;file&gt;</code></dt>
<dd><p>      Include source text of &lt;file&gt; at this position. The include file
      will be searched first in the current directory, then in all
      paths defined by &lsquo;<samp>-I</samp>&rsquo; or <code>incdir</code> in the order of
      occurence.
</p>
</dd>
<dt> <code>mac &lt;name&gt;</code></dt>
<dd><p>      Equivalent to <code>macro &lt;name&gt;</code>.
</p>
</dd>
<dt> <code>list</code></dt>
<dd><p>      The following lines will appear in the listing file, if it was
      requested.
</p>
</dd>
<dt> <code>local &lt;symbol&gt;[,&lt;symbol&gt;...]</code></dt>
<dd><p>      Flag &lt;symbol&gt; as a local symbol, which means that &lt;symbol&gt; is
      local for the current file and invisible to other modules in
      the linking process.
</p>
</dd>
<dt> <code>macro &lt;name&gt;[,&lt;argname&gt;...]</code></dt>
<dd><p>      Defines a macro which can be referenced by &lt;name&gt;. The &lt;name&gt;
      may also appear at the left side of the <code>macro</code> directive,
      starting at the first column. The macro definition is closed
      by an <code>endm</code> directive. When calling a macro you may pass
      up to 9 arguments, separated by comma. Those arguments are
      referenced within the macro context as <code>\1</code> to <code>\9</code>,
      or optionally by named arguments, which you have to specify in
      the operand.
      Argument <code>\0</code> is set to the macro&rsquo;s first qualifier
      (mnemonic extension), when given.
      The special argument <code>\@</code> inserts a unique id, useful for
      defining labels.
      <code>\()</code> may be used as a separator between the name of a macro
      argument and the subsequent text.
</p>
</dd>
<dt> <code>mdat &lt;file&gt;</code></dt>
<dd><p>      Equivalent to <code>incbin &lt;file&gt;</code>.
</p>
</dd>
<dt> <code>nolist</code></dt>
<dd><p>      The following lines will not be visible in a listing file.
</p>
</dd>
<dt> <code>org &lt;expression&gt;</code></dt>
<dd><p>      Sets the base address for the subsequent code. This is equivalent
      to <code>*=&lt;expression&gt;</code>.
</p>
</dd>
<dt> <code>phase &lt;expression&gt;</code></dt>
<dd><p>      Equivalent to <code>rorg &lt;expression&gt;</code>.
</p>
</dd>
<dt> <code>repeat &lt;expression&gt;</code></dt>
<dd><p>      Equivalent to <code>rept &lt;expression&gt;</code>.
</p>
</dd>
<dt> <code>rept &lt;expression&gt;</code></dt>
<dd><p>      Repeats the assembly of the block between <code>rept</code> and <code>endr</code>
      &lt;expression&gt; number of times. &lt;expression&gt; has to be positive.
</p>
</dd>
<dt> <code>reserve &lt;exp&gt;</code></dt>
<dd><p>      Equivalent to <code>blk &lt;exp&gt;,0</code>.
</p>
</dd>
<dt> <code>rend</code></dt>
<dd><p>      Ends a <code>rorg</code> block of label relocation. Following labels will
      be based on <code>org</code> again.
</p>
</dd>
<dt> <code>rorg &lt;expression&gt;</code></dt>
<dd><p>      Relocate all labels between <code>rorg</code> and <code>rend</code> based on the
      new origin.
      Note that this directive only makes sense when generating absolute
      code using <code>org</code>.
</p>
</dd>
<dt> <code>section &lt;name&gt;[,&quot;&lt;attributes&gt;&quot;]</code></dt>
<dd><p>      Starts a new section named &lt;name&gt; or reactivate an old one. If
      attributes are given for an already existing section, they must
      match exactly. The section&rsquo;s name will also be defined as a new
      symbol, which represents the section&rsquo;s start address.
      The &quot;&lt;attributes&gt;&quot; string may consist of the following characters:
</p>
<p>      Section Contents:
</p><dl compact="compact">
<dt> <code>c</code> </dt>
<dd><p>         section has code
</p>
</dd>
<dt> <code>d</code> </dt>
<dd><p>         section has initialized data
</p>
</dd>
<dt> <code>u</code> </dt>
<dd><p>         section has uninitialized data
</p>
</dd>
<dt> <code>i</code> </dt>
<dd><p>         section has directives (info section)
</p>
</dd>
<dt> <code>n</code> </dt>
<dd><p>         section can be discarded
</p>            
</dd>
<dt> <code>R</code> </dt>
<dd><p>         remove section at link time
</p>            
</dd>
<dt> <code>a</code> </dt>
<dd><p>         section is allocated in memory
</p></dd>
</dl>

<p>      Section Protection:
</p>
<dl compact="compact">
<dt> <code>r</code></dt>
<dd><p>         section is readable
</p>            
</dd>
<dt> <code>w</code></dt>
<dd><p>         section is writable
</p>           
</dd>
<dt> <code>x</code></dt>
<dd><p>         section is executable
</p>           
</dd>
<dt> <code>s</code></dt>
<dd><p>         section is sharable
</p></dd>
</dl>

</dd>
<dt> <code>&lt;symbol&gt; set &lt;expression&gt;</code></dt>
<dd><p>      Create a new symbol with the name &lt;symbol&gt; and assign
      the value of &lt;expression&gt;. If &lt;symbol&gt; is already assigned, it will
      contain a new value from now on.
</p>
</dd>
<dt> <code>spc &lt;exp&gt;</code></dt>
<dd><p>      Equivalent to <code>blk &lt;exp&gt;,0</code>.
</p>
</dd>
<dt> <code>string &quot;&lt;string1&gt;&quot;[,&quot;&lt;string2&gt;&quot;...]</code></dt>
<dd><p>      Like <code>text</code>, but adds a terminating zero-byte.
</p>
</dd>
<dt> <code>struct &lt;name&gt;</code></dt>
<dd><p>      Defines a structure which can be referenced by &lt;name&gt;. Labels within
      a structure definitation can be used as field offsets. They will be
      defined as local labels of <code>&lt;name&gt;</code> and can be referenced through
      <code>&lt;name&gt;.&lt;label&gt;</code>. All directives are allowed, but instructions will
      be ignored when such a structure is used. Data definitions can be used as
      default values when the structure is used as initializer. The structure
      name, &lt;name&gt;, is defined as a global symbol with the structure&rsquo;s size.
      A structure definition is ended by <code>endstruct</code>.
</p>
</dd>
<dt> <code>structure &lt;name&gt;</code></dt>
<dd><p>      Equivalent to <code>struct &lt;name&gt;</code>.
</p>
</dd>
<dt> <code>text &quot;&lt;string&gt;&quot;</code></dt>
<dd><p>      Places a single string constant operands into successive bytes of
      memory in the current section. The string delimiters may be any
      printable ASCII character.
</p>
</dd>
<dt> <code>weak &lt;symbol&gt;[,&lt;symbol&gt;...]</code></dt>
<dd><p>      Flag &lt;symbol&gt; as a weak symbol, which means that &lt;symbol&gt; is
      visible to all modules in the linking process and may be replaced
      by any global symbol with the same name.
      When a weak symbol remains undefined its value defaults to 0.
</p>
</dd>
<dt> <code>wor &lt;exp1&gt;[,&lt;exp2&gt;...]</code></dt>
<dd><p>      Equivalent to <code>word &lt;exp1&gt;[,&lt;exp2&gt;...]</code>.
</p>
</dd>
<dt> <code>wrd</code></dt>
<dd><p>      Increases the program counter by two.
      Equivalent to <code>blkw 1,0</code>.
</p>
</dd>
<dt> <code>word &lt;exp1&gt;[,&lt;exp2&gt;...]</code></dt>
<dd><p>      Assign the values of the operands into successive 16-bit words
      of memory in the current section, using the endianess of the target
      CPU.
</p>
</dd>
<dt> <code>xdef  &lt;symbol&gt;[,&lt;symbol&gt;...]</code></dt>
<dd><p>        See <code>global</code>.
</p>
</dd>
<dt> <code>xlib  &lt;symbol&gt;[,&lt;symbol&gt;...]</code></dt>
<dd><p>        See <code>global</code>.
</p>
</dd>
<dt> <code>xref  &lt;symbol&gt;[,&lt;symbol&gt;...]</code></dt>
<dd><p>        See <code>global</code>.
</p>
</dd>
</dl>


<hr size="6">
<a name="Structures-1"></a>
<h2 class="section">5.5 Structures</h2>
<p>The oldstyle syntax is able to manage structures.
Structures can be defined in two ways:
</p><table><tr><td>&nbsp;</td><td><pre class="example">mylabel struct[ure]
        &lt;fields&gt;
        endstruct[ure]
</pre></td></tr></table>
 
<p>        or:    
</p><table><tr><td>&nbsp;</td><td><pre class="example">        struct[ure] mylabel
        &lt;fields&gt;
        endstruct[ure]
</pre></td></tr></table>
 

<p>Any directive is allowed to define the structure fields. Labels can be used
to define offsets into the structure. The initialized data is used as default
value, whenever no value is given for a field when the structure is referenced.
</p>
<p>Some examples of structure declarations:
</p><table><tr><td>&nbsp;</td><td><pre class="example">  struct point
x    db 4
y    db 5
z    db 6
  endstruct
</pre></td></tr></table>

<p>This will create the following labels:
</p><table><tr><td>&nbsp;</td><td><pre class="example">point.x  ; 0   offsets
point.y  ; 1
point.z  ; 2
point    ; 3   size of the structure
</pre></td></tr></table>

<p>The structure can be used by optionaly redefining the fields value:
</p><table><tr><td>&nbsp;</td><td><pre class="example">point1 point
point2 point 1, 2, 3
point3 point ,,4
</pre></td></tr></table>
<p>is equivalent to
</p><table><tr><td>&nbsp;</td><td><pre class="example">point1  
               db 4
               db 5
               db 6
point2
               db 1
               db 2
               db 3
point3
               db 4
               db 5
               db 4
</pre></td></tr></table>


<hr size="6">
<a name="Known-Problems-7"></a>
<h2 class="section">5.6 Known Problems</h2>

<p>    Some known problems of this module at the moment:
</p>
<ul class="toc">
<li>- Addresses assigned to <code>org</code> or to the current pc symbol <code>'*'</code>
(on the z80 the pc symbol is <code>'$'</code>) must be constant.

</li><li>- Expressions in an <code>if</code> directive must be constant.

</li></ul>

<hr size="6">
<a name="Error-Messages"></a>
<h2 class="section">5.7 Error Messages</h2>

<p>This module has the following error messages:
</p>
<ul class="toc">
<li>- 1001: syntax error
</li><li>- 1002: invalid extension
</li><li>- 1003: no space before operands
</li><li>- 1004: too many closing parentheses
</li><li>- 1005: missing closing parentheses
</li><li>- 1006: missing operand
</li><li>- 1007: garbage at end of line
</li><li>- 1008: %c expected
</li><li>- 1009: invalid data operand
</li><li>- 1010: , expected
</li><li>- 1011: identifier expected
</li><li>- 1012: illegal escape sequence \%c
</li><li>- 1013: expression must be a constant
</li><li>- 1014: repeatedly defined symbol
</li><li>- 1015: endif without if
</li><li>- 1016: if without endif
</li><li>- 1017: maximum if-nesting depth exceeded (%d levels)
</li><li>- 1018: else without if
</li><li>- 1019: unexpected endr without macro
</li><li>- 1020: unexpected endr without rept
</li><li>- 1021: cannot open binary file &quot;%s&quot;
</li><li>- 1022: symbol &lt;%s&gt; already defined with %s scope
</li><li>- 1023: alignment too big
</li><li>- 1024: label &lt;%s&gt; had already been defined
</li><li>- 1025: skipping instruction in struct init
</li><li>- 1026: last %d bytes of string constant had been cut

</li></ul>

<hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Oldstyle-Syntax-Module" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="vasm_5.html#Simple-binary-output-module" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="vasm_0.html#General-9" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="vasm_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="vasm_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>Luis Panadero Guardeño</em> on <em>January 13, 2015</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
 </font>
 <br>

</p>
</body>
</html>
