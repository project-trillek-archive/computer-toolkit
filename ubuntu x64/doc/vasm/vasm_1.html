<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on January 13, 2015 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>vasm manual: 2. The Assembler</title>

<meta name="description" content="vasm manual: 2. The Assembler">
<meta name="keywords" content="vasm manual: 2. The Assembler">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.roman {font-family:serif; font-weight:normal;}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="vasm_0.html#General-9" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="vasm_2.html#Standard-Syntax-Module" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="vasm_0.html#General-9" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="vasm_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="vasm_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>

<hr size="2">
<a name="The-Assembler"></a>
<a name="The-Assembler-1"></a>
<h1 class="chapter">2. The Assembler</h1>
<p>This chapter describes the module-independent part of the assembler. It
documents the options and extensions which are not specific to a certain
target, syntax or output driver. Be sure to also read the chapters on the
backend, syntax- and output-module you are using. They will
likely contain important additional information like data-representation
or additional options.
</p>
<hr size="6">
<a name="General-Assembler-Options"></a>
<a name="General-Assembler-Options-1"></a>
<h2 class="section">2.1 General Assembler Options</h2>

<p>    <code>vasm</code> is run using the following syntax:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">      <code>vasm&lt;target&gt;_&lt;syntax&gt; [options] file</code>
</pre></td></tr></table>

<p>    The following options are supported by the machine independent part
    of <code>vasm</code>:
</p>
<dl compact="compact">
<dt> &lsquo;<samp>-D&lt;name&gt;[=expression]</samp>&rsquo;</dt>
<dd><p>        Defines a symbol with the name &lt;name&gt; and assigns the value of the
        expression when given. The assigned value defaults to 1 otherwise.
</p>
</dd>
<dt> &lsquo;<samp>-esc</samp>&rsquo;</dt>
<dd><p>        Enable escape character sequences. This will make vasm treat the
        escape character \ in string constants similar as in the C language.
</p>
</dd>
<dt> &lsquo;<samp>-F&lt;fmt&gt;</samp>&rsquo;</dt>
<dd><p>        Use module &lt;fmt&gt; as output driver. See the chapter on output
        drivers for available formats and options.
</p>
</dd>
<dt> &lsquo;<samp>-I&lt;path&gt;</samp>&rsquo;</dt>
<dd><p>        Define another include path. They are searched in the order of
        occurence on the command line.
</p>
</dd>
<dt> &lsquo;<samp>-ignore-mult-inc</samp>&rsquo;</dt>
<dd><p>        When the same file is included multiple times with the same path
        this is silently ignored, causing the file to be processed only
        once. Note that you can still include the same file twice when
        using different paths to access it.
</p>
</dd>
<dt> &lsquo;<samp>-L &lt;listfile&gt;</samp>&rsquo;</dt>
<dd><p>        Enables generation of a listing file and directs the output into
        the file &lt;listfile&gt;.
</p>
</dd>
<dt> &lsquo;<samp>-Ll&lt;lines&gt;</samp>&rsquo;</dt>
<dd><p>        Set the number of lines per listing file page to &lt;lines&gt;.
</p>
</dd>
<dt> &lsquo;<samp>-Lnf</samp>&rsquo;</dt>
<dd><p>        Do not emit any form feed code into the listing file, for starting
        a new page.
</p>
</dd>
<dt> &lsquo;<samp>-Lns</samp>&rsquo;</dt>
<dd><p>        Do not include symbols in the listing file.
</p>
</dd>
<dt> &lsquo;<samp>-maxerrors=&lt;n&gt;</samp>&rsquo;</dt>
<dd><p>        Defines the maximum number of errors to display before assembly
        is aborted. When &lt;n&gt; is 0 then there is no limit. Defaults to 5.
</p>
</dd>
<dt> &lsquo;<samp>-maxmacrecurs=&lt;n&gt;</samp>&rsquo;</dt>
<dd><p>        Defines the maximum of number of recursions within a macro.
        Defaults to 1000.
</p>
</dd>
<dt> &lsquo;<samp>-nocase</samp>&rsquo;</dt>
<dd><p>        Disables case-sensitivity for everything - identifiers, directives
        and instructions. Note that directives and instructions may already
        be case-insensitive by default in some modules.
</p>
</dd>
<dt> &lsquo;<samp>-noesc</samp>&rsquo;</dt>
<dd><p>        No escape character sequences. This will make vasm treat the
        escape character \ as any other character. Might be useful for
        compatibility.
</p>
</dd>
<dt> &lsquo;<samp>-nosym</samp>&rsquo;</dt>
<dd><p>        Strips all local symbols from the output file and doesn&rsquo;t include
        any other symbols than those which are required for external
        linkage.
</p>
</dd>
<dt> &lsquo;<samp>-nowarn=&lt;n&gt;</samp>&rsquo;</dt>
<dd><p>        Disable warning message &lt;n&gt;. &lt;n&gt; has to be the number of a valid
        warning message, otherwise an error is generated.
</p>
</dd>
<dt> &lsquo;<samp>-o &lt;ofile&gt;</samp>&rsquo;</dt>
<dd><p>        Write the generated assembler output to &lt;ofile&gt; rather than
        &lsquo;<tt>a.out</tt>&rsquo;.
</p>
</dd>
<dt> &lsquo;<samp>-pic</samp>&rsquo;</dt>
<dd><p>        Try to generate position independant code. Every relocation is
        flagged by an error message.
</p>
</dd>
<dt> &lsquo;<samp>-quiet</samp>&rsquo;      </dt>
<dd><p>        Do not print the copyright notice and the final statistics.
</p>
</dd>
<dt> &lsquo;<samp>-unnamed-sections</samp>&rsquo;</dt>
<dd><p>        Sections are no longer distinguished by their name, but only by
        their attributes. This has the effect that when defining a second
        section with a different name but same attributes as a first one,
        it will switch to the first, instead of starting a new section.
</p>
</dd>
<dt> &lsquo;<samp>-unsshift</samp>&rsquo;</dt>
<dd><p>        The shift-right operator (<code>&gt;&gt;</code>) treats the value to shift as
        unsigned, which has the effect that 0-bits are inserted on the
        left side. The number of bits in a value depend on the target
        address type (refer to the appropriate cpu module documentation).
</p>
</dd>
<dt> &lsquo;<samp>-w</samp>&rsquo;</dt>
<dd><p>        Hide all warning messages.
</p>
</dd>
<dt> &lsquo;<samp>-x</samp>&rsquo;</dt>
<dd><p>        Show an error message, when referencing an undefined symbol.
        The default behaviour is to declare this symbol as externally
        defined.
</p>
</dd>
</dl>

<p>Note that while most options allow an argument without any separating blank,
some others require it (e.g. &lsquo;<samp>-o</samp>&rsquo; and &lsquo;<samp>-L</samp>&rsquo;).
</p>
<hr size="6">
<a name="Expressions"></a>
<h2 class="section">2.2 Expressions</h2>

<p>Standard expressions are usually evaluated by the main part of vasm
rather than by one of the modules (unless this is necessary).
</p>
<p>All expressions evaluated by the frontend are calculated in terms
of target address values, i.e. the range depends on the backend.
</p>
<p>The available operators include all those which are common in assembler as
well as in C expressions.
</p>
<p>C like operators:
</p><ul>
<li> Unary: <code>+ - ! ~</code>
</li><li> Arithmetic: <code>+ - * / % &lt;&lt; &gt;&gt;</code>
</li><li> Bitwise: <code>&amp; | ^</code>
</li><li> Logical: <code>&amp;&amp; ||</code>
</li><li> Comparative: <code>&lt; &gt; &lt;= &gt;= == !=</code>
</li></ul>

<p>Assembler like operators:
</p><ul>
<li> Unary: <code>+ - ~</code>
</li><li> Arithmetic: <code>+ - * / // &lt;&lt; &gt;&gt;</code>
</li><li> Bitwise: <code>&amp; ! ~</code>
</li><li> Comparative: <code>&lt; &gt; &lt;= &gt;= = &lt;&gt;</code>
</li></ul>

<p>Up to version 1.4b the operators had the same precedence and associativity as
in the C language. Newer versions have changed the operator priorities to
comply with the common assembler behaviour. The expression evaluation
priorities, from highest to lowest, are:
</p>
<ol>
<li> <code>+ - ! ~</code> (unary +/- sign, not, complement)
</li><li> <code>&lt;&lt; &gt;&gt;</code> (shift left, shift right)
</li><li> <code>&amp;</code> (bitwise and)
</li><li> <code>^ ~</code> (bitwise exclusive-or)
</li><li> <code>| !</code> (bitwise inclusive-or)
</li><li> <code>* / % //</code> (multiply, divide, modulo)
</li><li> <code>+ -</code> (plus, minus)
</li><li> <code>&lt; &gt; &lt;= &gt;=</code> (less, greater, less or equal, greater or equal)
</li><li> <code>== != = &lt;&gt;</code> (equality, inequality)
</li><li> <code>&amp;&amp;</code> (logical and)
</li><li> <code>||</code> (logical or)
</li></ol>

<p>Operands are integral values of the target address type. They can either be
specified as integer constants of different bases (see the documentation
on the syntax module to see how the base is specified) or character
constants. Character constants are introduced by <code>'</code> or <code>&quot;</code>
and have to be terminated by the same character that started them.
</p>
<p>Multiple characters are allowed and a constant is built according to the
endianess of the target.
</p>
<p>When the &lsquo;<samp>-esc</samp>&rsquo; option was specified, or automatically enabled by
a syntax module, vasm interprets escape character sequences as in the
C language:
</p>
<dl compact="compact">
<dt> <code>\\</code></dt>
<dd><p>        Produces a single <code>\</code>.
</p>
</dd>
<dt> <code>\b</code></dt>
<dd><p>        The bell character.
</p>
</dd>
<dt> <code>\f</code></dt>
<dd><p>        Form feed.
</p>
</dd>
<dt> <code>\n</code></dt>
<dd><p>        Line feed.
</p>
</dd>
<dt> <code>\r</code></dt>
<dd><p>        Carriage return.
</p>
</dd>
<dt> <code>\t</code></dt>
<dd><p>        Tabulator.
</p>
</dd>
<dt> <code>\&quot;</code></dt>
<dd><p>        Produces a single <code>&quot;</code>.
</p>    
</dd>
<dt> <code>\'</code></dt>
<dd><p>        Produces a single <code>'</code>.
</p>
</dd>
<dt> <code>\e</code></dt>
<dd><p>        Escape character (27).
</p>
</dd>
<dt> <code>\&lt;octal-digits&gt;</code></dt>
<dd><p>        One character with the code specified by the digits
        as octal value.
</p>
</dd>
<dt> <code>\x&lt;hexadecimal-digits&gt;</code></dt>
<dd><p>        One character with the code specified by the digits
        as hexadecimal value.
</p>
</dd>
<dt> <code>\X&lt;hexadecimal-digits&gt;</code></dt>
<dd><p>        Same as <code>\x</code>.
</p>
</dd>
</dl>

<p>Note, that the default behaviour of vasm has changed since V1.7! Escape
sequence handling has been the default in older versions. This has been
changed to increase compatibility with other assemblers. Use &lsquo;<samp>-esc</samp>&rsquo;
to assemble sources with escape character sequences. It is still the
default in the <code>std</code> syntax module, though.
</p>
<hr size="6">
<a name="Symbols-1"></a>
<h2 class="section">2.3 Symbols</h2>

<p>You can define as many symbols as your available memory permits. A symbol
may have any length and can be of global or local scope. Internally, there
are three types of symbols:
</p><dl compact="compact">
<dt> <code>Expression</code></dt>
<dd><p>      These symbols are usually not visible outside the
      source, unless they are explicitely exported.
</p></dd>
<dt> <code>Label</code></dt>
<dd><p>      Labels are always addresses inside a program section. By
      default they have local scope for the linker.
</p></dd>
<dt> <code>Imported</code></dt>
<dd><p>      These symbols are externally defined and must be
      resolved by the linker.
</p></dd>
</dl>

<p>Beginning with vasm V1.5c one expression symbol is always defined to allow
conditional assembly depending on the assembler being used: <code>__VASM</code>.
Its value depends on the selected cpu module. There may be other symbols which
are pre-defined by the syntax- or by the cpu module.
</p>
<hr size="6">
<a name="Include-Files"></a>
<h2 class="section">2.4 Include Files</h2>

<p>Vasm supports include files and defining include paths. Whether this
functionality is available depends on the syntax module, which has to
provide the appropriate directives.
</p>
<p>On startup vasm will define at least one default include path: the
current working directory, where the assembler program was launched from.
When the input file is loaded from a different directory, i.e. the input
file is a relative or absolute path and not a single file name, then the
path to the input file name will be added as another include path.
</p>
<p>Include paths are searched in the following order:
</p><ol>
<li> Current work directory.
</li><li> Paths specified by &lsquo;<samp>-I</samp>&rsquo; in the order of occurence on the
      command line.
</li><li> Path to the input source file.
</li><li> Paths specified by directives inside the source text (in the order
      of occurence).
</li></ol>

<hr size="6">
<a name="Macros"></a>
<h2 class="section">2.5 Macros</h2>

<p>Macros are supported by vasm, but the directives for defining them have
to be implemented in the syntax module. In any case the assembler core
allows up to 9 macro parameters by default (extendable to up to 36 parameters)
to be passed in the operand field.
They can be referenced inside the macro by <code>\1</code> to <code>\9</code>.
Additionally there is a special argument <code>\0</code> which is set to the
first qualifier (mnemonic extension) of the macro invocation when given.
</p>
<p>A macro parameter which is enclosed inside <code>&lt;</code> and <code>&gt;</code> characters
is treated as a single parameter, even when it contains commas. <code>&gt;</code>
characters within such a parameter may be specified as <code>&gt;&gt;</code>.
</p>
<p><code>\@</code> inserts a unique id of the form <code>_nnnnnn</code> (where
&rsquo;<code>n</code>&rsquo; is a digit between 0 and 9) per macro invocation. Useful
for defining reusable labels in a macro.
</p>
<p><code>\@!</code> does the same, but pushes the id onto an internal stack.
</p>
<p><code>\@@</code> insert the id from top of the id-stack.
</p>
<p><code>\#</code> is replaced by the number of parameters given to the current
macro invocation.
</p>
<p><code>\?n</code> represents the total length of parameter <code>n</code> in bytes.
Note that the quotes of a string parameter are included in this length.
</p>
<hr size="6">
<a name="Structures"></a>
<h2 class="section">2.6 Structures</h2>

<p>Vasm supports structures, but the directives for defining them
have to be implemented in the syntax module.
</p>
<hr size="6">
<a name="Conditional-Assembly"></a>
<h2 class="section">2.7 Conditional Assembly</h2>

<p>Has to be provided completely by the syntax module.
</p>
<hr size="6">
<a name="Known-Problems"></a>
<h2 class="section">2.8 Known Problems</h2>

<p>    Some known module-independent problems of <code>vasm</code> at the moment:
</p>
<ul class="toc">
<li>- None.

</li></ul>

<hr size="6">
<a name="Credits"></a>
<h2 class="section">2.9 Credits</h2>

<p>    All those who wrote parts of the <code>vasm</code> distribution, made suggestions,
    answered my questions, tested <code>vasm</code>, reported errors or were otherwise
    involved in the development of <code>vasm</code> (in descending alphabetical order,
    under work, not complete):
</p>
<ul>
<li> Frank Wille
    </li><li> Sebastian Pachuta
    </li><li> Esben Norby
    </li><li> Gunther Nikl
    </li><li> George Nakos
    </li><li> Timm S. Mueller
    </li><li> Gareth Morris
    </li><li> Dominic Morris
    </li><li> Mauricio Mu&ntilde;oz Lucero
    </li><li> J&ouml;rg van de Loo
    </li><li> Robert Leffmann
    </li><li> Miro Kropacek
    </li><li> Mikael Kalms
    </li><li> Matthew Hey
    </li><li> Philippe Guichardon
    </li><li> Romain Giot
    </li><li> Francois Galea
    </li><li> Tom Duin
    </li><li> Karoly Balogh
</li></ul>

<hr size="6">
<a name="Error-Messages-2"></a>
<h2 class="section">2.10 Error Messages</h2>

<p>The frontend has the following error messages:
</p>
<ul class="toc">
<li>- 1: illegal operand types
</li><li>- 2: unknown mnemonic &lt;%s&gt;
</li><li>- 3: unknown section &lt;%s&gt;
</li><li>- 4: no current section specified
</li><li>- 5: internal error %d in line %d of %s
</li><li>- 6: symbol &lt;%s&gt; redefined
</li><li>- 7: %c expected
</li><li>- 8: cannot resolve section &lt;%s&gt;, maximum number of passes reached
</li><li>- 9: instruction not supported on selected architecture
</li><li>- 10: number or identifier expected
</li><li>- 11: could not initialize %s module
</li><li>- 12: multiple input files
</li><li>- 13: could not open &lt;%s&gt; for input
</li><li>- 14: could not open &lt;%s&gt; for output
</li><li>- 15: unknown option &lt;%s&gt;
</li><li>- 16: no input file specified
</li><li>- 17: could not initialize output module &lt;%s&gt;
</li><li>- 18: out of memory
</li><li>- 19: symbol &lt;%s&gt; recursively defined
</li><li>- 20: fail: %s
</li><li>- 21: section offset is lower than current pc
</li><li>- 22: character constant too long
</li><li>- 23: undefined symbol &lt;%s&gt;
</li><li>- 24: trailing garbage after option -%c
</li><li>- 25: bad operand
</li><li>- 26: missing end directive for macro &quot;%s&quot;
</li><li>- 27: macro definition inside macro &quot;%s&quot;
</li><li>- 28: maximum number of %d macro arguments exceeded
</li><li>- 29: option -%c was specified twice
</li><li>- 30: read error on &lt;%s&gt;
</li><li>- 31: expression must be constant
</li><li>- 32: initialized data in bss
</li><li>- 33: missing end directive in repeat-block
</li><li>- 34: #%d is not a valid warning message
</li><li>- 35: relocation not allowed
</li><li>- 36: illegal escape sequence \%c
</li><li>- 37: no current macro to exit
</li><li>- 38: internal symbol %s redefined by user
</li><li>- 39: illegal relocation
</li><li>- 40: macro id stack overflow
</li><li>- 41: macro id pull without matching push
</li><li>- 42: division by zero
</li><li>- 43: illegal macro argument
</li><li>- 44: reloc org is already set
</li><li>- 45: reloc org was not set
</li><li>- 46: macro id insert on empty stack
</li><li>- 47: bad file-offset argument
</li><li>- 48: assertion &quot;%s&quot; failed: %s
</li><li>- 49: cannot declare structure within structure
</li><li>- 50: no structure
</li><li>- 51: instruction has been auto-aligned
</li><li>- 52: macro name conflicts with mnemonic
</li><li>- 53: macro name conflicts with directive
</li><li>- 54: non-relocatable expression in equate &lt;%s&gt;
</li><li>- 55: line buffer overflow
</li><li>- 56: illegal structure recursion
</li><li>- 57: maximum number of macro recursions (%d) reached
</li><li>- 58: data has been auto-aligned
</li><li>- 59: register symbol &lt;%s&gt; redefined
</li><li>- 60: cannot evaluate constant huge integer expression
</li><li>- 61: cannot evaluate floating point expression
</li><li>- 62: imported symbol &lt;%s&gt; was not referenced
</li><li>- 63: alignment padding (%lu) not a multiple of %lu

</li></ul>

<hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#The-Assembler" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="vasm_2.html#Standard-Syntax-Module" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="vasm_0.html#General-9" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="vasm_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="vasm_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>Luis Panadero Guardeño</em> on <em>January 13, 2015</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
 </font>
 <br>

</p>
</body>
</html>
